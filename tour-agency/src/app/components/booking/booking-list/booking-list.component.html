<div class="booking-container">
  <div class="booking-header">
    <h1>My Bookings</h1>
  </div>

  <div *ngIf="successMessage" class="alert alert-success">{{ successMessage }}</div>
  <div *ngIf="error" class="alert alert-danger">{{ error }}</div>

  <div *ngIf="loading" class="text-center py-5">
    <div class="spinner-border text-primary" role="status">
      <span class="sr-only">Loading...</span>
    </div>
  </div>

  <div *ngIf="!loading && bookings.length === 0" class="empty-bookings">
    <div class="empty-message">
      <i class="fa fa-calendar-o fa-4x"></i>
      <h3>You have no bookings</h3>
      <p>Browse our packages and book your next adventure</p>
      <button class="btn btn-primary" routerLink="/packages">Browse Packages</button>
    </div>
  </div>

  <div *ngIf="!loading && bookings.length > 0" class="booking-content">
    <div class="booking-filters">
      <div class="btn-group" role="group">
        <button 
          type="button" 
          class="btn" 
          [ngClass]="statusFilter === 'all' ? 'btn-primary' : 'btn-outline-primary'"
          (click)="filterBookings('all')">
          All
        </button>
        <button 
          type="button" 
          class="btn" 
          [ngClass]="statusFilter === 'CONFIRMED' ? 'btn-primary' : 'btn-outline-primary'"
          (click)="filterBookings('CONFIRMED')">
          Confirmed
        </button>
        <button 
          type="button" 
          class="btn" 
          [ngClass]="statusFilter === 'PENDING' ? 'btn-primary' : 'btn-outline-primary'"
          (click)="filterBookings('PENDING')">
          Pending
        </button>
        <button 
          type="button" 
          class="btn" 
          [ngClass]="statusFilter === 'CANCELLED' ? 'btn-primary' : 'btn-outline-primary'"
          (click)="filterBookings('CANCELLED')">
          Cancelled
        </button>
        <button 
          type="button" 
          class="btn" 
          [ngClass]="statusFilter === 'COMPLETED' ? 'btn-primary' : 'btn-outline-primary'"
          (click)="filterBookings('COMPLETED')">
          Completed
        </button>
      </div>
    </div>

    <div class="booking-list">
      <div *ngFor="let booking of bookings" class="booking-card">
        <div class="booking-header">
          <div class="booking-ref">
            <span class="ref-label">Booking Ref:</span>
            <span class="ref-value">{{ booking.bookingReference }}</span>
          </div>
          <div class="booking-status" [ngClass]="'status-' + (booking.bookingStatus ? booking.bookingStatus.toLowerCase() : 'unknown')">
            {{ booking.bookingStatus || 'Unknown' }}
          </div>
        </div>
        
        <div class="booking-body">
          <div class="booking-package">
            <div class="package-image">
              <img [src]="booking.tourPackage?.image || 'assets/images/placeholder.jpg'" [alt]="booking.tourPackage?.name || 'Package'">
            </div>
            <div class="package-details">
              <h3 class="package-name">{{ booking.tourPackage?.name || 'Unknown Package' }}</h3>
              <div class="booking-dates">
                <span class="date-label">Dates:</span>
                <span class="date-value">{{ booking.startDate | date }} - {{ booking.endDate | date }}</span>
              </div>
              <div class="booking-travelers">
                <span class="travelers-label">Travelers:</span>
                <span class="travelers-value">{{ booking.numberOfAdults }} Adults, {{ booking.numberOfChildren }} Children</span>
              </div>
            </div>
          </div>
          
          <div *ngIf="booking.addons && booking.addons.length > 0" class="booking-addons">
            <h4>Selected Add-ons:</h4>
            <ul class="addon-list">
              <li *ngFor="let addon of booking.addons" class="addon-item">
                <span class="addon-name">{{ addon.addon.name }}</span>
                <span class="addon-quantity">x{{ addon.quantity }}</span>
                <span class="addon-price">${{ (addon.priceAtBooking || 0) * addon.quantity | number:'1.2-2' }}</span>
              </li>
            </ul>
          </div>
          
          <div class="booking-payment">
            <div class="payment-status">
              <span class="status-label">Payment Status:</span>
              <span class="status-value" [ngClass]="'payment-' + (booking.paymentStatus ? booking.paymentStatus.toLowerCase() : 'unknown')">
                {{ booking.paymentStatus || 'Unknown' }}
              </span>
            </div>
            <div class="booking-price">
              <span class="price-label">Total Price:</span>
              <span class="price-value">${{ booking.totalPrice | number:'1.2-2' }}</span>
            </div>
          </div>
        </div>
        
        <div class="booking-footer">
          <div class="booking-date">
            <span class="date-label">Booked on:</span>
            <span class="date-value">{{ booking.createdAt | date }}</span>
          </div>
          <div class="booking-actions">
            <button 
              *ngIf="booking.bookingStatus === 'CONFIRMED' || booking.bookingStatus === 'PENDING'" 
              class="btn btn-danger" 
              (click)="cancelBooking(booking.id)">
              Cancel Booking
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
